import asyncio
import aiohttp
from html_fetcher import HTMLFetcher

async def main():
    async with aiohttp.ClientSession() as session:
        fetcher = HTMLFetcher(session)

        # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞ (—Å—Ç—Ä–∞–Ω–∏—Ü–∞ 1)
        html_catalog = await fetcher.fetch_catalog_page(1)
        if html_catalog:
            print("–ö–∞—Ç–∞–ª–æ–≥ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!")

        # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–µ—Ç–∞–ª–∏ –ø–æ —Å—Å—ã–ª–∫–µ
        url = "https://motorland.by/engines/opel/astra/j-2010-2017/1-6-litra/dizel/cdti/b16dtl/sku-20637378/"
        html_detail = await fetcher.fetch_detail_page(url)
        if html_detail:
            print("–°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–µ—Ç–∞–ª–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!")

asyncio.run(main())
üîç –ú–µ—Ç–æ–¥—ã
–ú–µ—Ç–æ–¥	–û–ø–∏—Å–∞–Ω–∏–µ	–ê—Ä–≥—É–º–µ–Ω—Ç—ã
fetch(url, retries=3, delay=1.0)	–ó–∞–≥—Ä—É–∂–∞–µ—Ç HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ URL —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö.	url ‚Äî –∞–¥—Ä–µ—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã, retries ‚Äî –∫–æ–ª-–≤–æ –ø–æ–ø—ã—Ç–æ–∫, delay ‚Äî –ø–∞—É–∑–∞ –º–µ–∂–¥—É –Ω–∏–º–∏
fetch_catalog_page(page_num=1)	–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–∞—Ç–∞–ª–æ–≥–∞ (?pg=N). –ï—Å–ª–∏ page_num=1, –±–µ—Ä—ë—Ç –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.	page_num ‚Äî –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
fetch_detail_page(url)	–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–µ—Ç–∞–ª–∏ –ø–æ –ø–æ–ª–Ω–æ–π —Å—Å—ã–ª–∫–µ.	url ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ –¥–µ—Ç–∞–ª—å

üß† –ü—Ä–∏–º–µ—á–∞–Ω–∏—è
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –º–æ–¥—É–ª—å logging.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ aiohttp.ClientError.

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç str —Å HTML-—Ç–µ–∫—Å—Ç–æ–º –ø—Ä–∏ —É—Å–ø–µ—Ö–µ –∏–ª–∏ None –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ.

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –ø–∞—Ä—Å–µ—Ä–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, BeautifulSoup –∏–ª–∏ lxml –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ).